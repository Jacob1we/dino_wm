  W&B Run: https://wandb.ai/jacob-weyer-rwth-aachen-university/dino_wm_planning/runs/jrotcwbt
✓ Setup komplett
  Modus: ONLINE
  CEM: samples=300, steps=5, topk=30, horizon=5
  Suchraum: 60D (H=5 × D=12)
Server laeuft auf localhost:5555
Warte auf Client...
[+] Client: ('127.0.0.1', 56146)
  W&B Config aktualisiert mit Client-Config (12 Keys)
  Client-Config empfangen: ['port', 'n_episodes', 'max_steps', 'headless', 'goal_image', 'settle_steps', 'ee_threshold', 'timeout', 'mode', 'log_dir', 'robot_opacity_for_capture', 'scene_config']
  Reset
  Goal gesetzt: (224, 224, 3) uint8, ee_pos=[0.3188095  0.13228466 0.07317299]
    CEM step 1: loss=1.055399
    CEM step 2: loss=0.987056
    CEM step 3: loss=0.978884
    CEM step 4: loss=0.918800
    CEM step 5: loss=0.949592
  Plan: 1.055399 → 0.949592 (10.0% Reduktion, 58.8s)
    Sub-Action 0: target_ee=[0.482, 0.112, 0.214]
    CEM step 1: loss=1.013558
    CEM step 2: loss=1.004581
    CEM step 3: loss=0.956066
    CEM step 4: loss=0.947306
    CEM step 5: loss=0.951833
  Plan: 1.013558 → 0.951833 (6.1% Reduktion, 55.9s)
    Sub-Action 0: target_ee=[0.494, 0.057, 0.238]
[-] Client getrennt
[+] Client: ('127.0.0.1', 55958)
  W&B Config aktualisiert mit Client-Config (12 Keys)
  Client-Config empfangen: ['port', 'n_episodes', 'max_steps', 'headless', 'goal_image', 'settle_steps', 'ee_threshold', 'timeout', 'mode', 'log_dir', 'robot_opacity_for_capture', 'scene_config']
  Reset
  Goal gesetzt: (224, 224, 3) uint8, ee_pos=[0.3188095  0.13228466 0.07317299]
    CEM step 1: loss=1.142642
    CEM step 2: loss=1.035378
    CEM step 3: loss=0.895788
    CEM step 4: loss=0.912946
    CEM step 5: loss=0.887700
  Plan: 1.142642 → 0.887700 (22.3% Reduktion, 59.8s)
    Sub-Action 0: target_ee=[0.504, -0.017, 0.181]
    CEM step 1: loss=1.074470
    CEM step 2: loss=1.084102
    CEM step 3: loss=1.033375
    CEM step 4: loss=1.015286
    CEM step 5: loss=0.992040
  Plan: 1.074470 → 0.992040 (7.7% Reduktion, 60.1s)
    Sub-Action 0: target_ee=[0.495, 0.098, 0.243]
    CEM step 1: loss=1.039129
    CEM step 2: loss=1.099760
    CEM step 3: loss=1.087008
    CEM step 4: loss=1.044762
    CEM step 5: loss=1.048757
  Plan: 1.039129 → 1.048757 (-0.9% Reduktion, 60.7s)
    Sub-Action 0: target_ee=[0.524, -0.027, 0.188]
    CEM step 1: loss=1.124217
    CEM step 2: loss=1.097135
    CEM step 3: loss=1.115353
    CEM step 4: loss=1.083116
    CEM step 5: loss=1.086497
  Plan: 1.124217 → 1.086497 (3.4% Reduktion, 61.0s)
    Sub-Action 0: target_ee=[0.437, 0.198, 0.237]
    CEM step 1: loss=1.155475
    CEM step 2: loss=1.148404
    CEM step 3: loss=1.131734
    CEM step 4: loss=1.113853
    CEM step 5: loss=1.101105
  Plan: 1.155475 → 1.101105 (4.7% Reduktion, 60.4s)
    Sub-Action 0: target_ee=[0.639, -0.031, 0.173]
    CEM step 1: loss=1.113029
    CEM step 2: loss=1.095829
    CEM step 3: loss=1.083511
    CEM step 4: loss=1.046569
    CEM step 5: loss=1.065975
  Plan: 1.113029 → 1.065975 (4.2% Reduktion, 60.8s)
    Sub-Action 0: target_ee=[0.496, 0.056, 0.022]
    CEM step 1: loss=1.229017
    CEM step 2: loss=1.158597
    CEM step 3: loss=1.167496
    CEM step 4: loss=1.185050
    CEM step 5: loss=1.154797
  Plan: 1.229017 → 1.154797 (6.0% Reduktion, 60.6s)
    Sub-Action 0: target_ee=[0.571, 0.206, 0.178]
[-] Client getrennt
Traceback (most recent call last):
  File "/home/tsp_jw/Desktop/dino_wm/planning_server.py", line 553, in <module>
    actions, _ = planner.plan(
  File "/home/tsp_jw/Desktop/dino_wm/planning/cem.py", line 108, in plan
    i_z_obses, i_zs = self.wm.rollout(
  File "/home/tsp_jw/Desktop/dino_wm/planning_server.py", line 191, in rollout
    z_obses, zs = self._model.rollout(chunk_obs, chunk_act)
  File "/home/tsp_jw/Desktop/dino_wm/models/visual_world_model.py", line 299, in rollout
    z_pred = self.predict(z[:, -self.num_hist :])
  File "/home/tsp_jw/Desktop/dino_wm/models/visual_world_model.py", line 145, in predict
    z = self.predictor(z)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 119, in forward
    x = self.transformer(x)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 95, in forward
    x = attn(x) + x
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 80, in forward
    return self.to_out(out)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/tsp_jw/Desktop/dino_wm/planning_server.py", line 553, in <module>
    actions, _ = planner.plan(
  File "/home/tsp_jw/Desktop/dino_wm/planning/cem.py", line 108, in plan
    i_z_obses, i_zs = self.wm.rollout(
  File "/home/tsp_jw/Desktop/dino_wm/planning_server.py", line 191, in rollout
    z_obses, zs = self._model.rollout(chunk_obs, chunk_act)
  File "/home/tsp_jw/Desktop/dino_wm/models/visual_world_model.py", line 299, in rollout
    z_pred = self.predict(z[:, -self.num_hist :])
  File "/home/tsp_jw/Desktop/dino_wm/models/visual_world_model.py", line 145, in predict
    z = self.predictor(z)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 119, in forward
    x = self.transformer(x)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 95, in forward
    x = attn(x) + x
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 80, in forward
    return self.to_out(out)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 116, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
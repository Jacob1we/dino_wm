2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_setup.py:_flush():76] Configure stats pid to 2366777
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_setup.py:_flush():76] Loading settings from /home/tsp_jw/.config/wandb/settings
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_setup.py:_flush():76] Loading settings from /home/tsp_jw/Desktop/dino_wm/wandb/settings
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'_require_service': 'True'}
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'planning_server.py', 'program': '/home/tsp_jw/Desktop/dino_wm/planning_server.py'}
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_init.py:_log_setup():461] Logging user logs to /home/tsp_jw/Desktop/dino_wm/wandb/run-20260301_125150-jdjugpcl/logs/debug.log
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_init.py:_log_setup():462] Logging internal logs to /home/tsp_jw/Desktop/dino_wm/wandb/run-20260301_125150-jdjugpcl/logs/debug-internal.log
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_init.py:init():495] calling init triggers
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_init.py:init():498] wandb.init called with sweep_config: {}
config: {'model_name': '260301/10-03', 'model_path': '/home/tsp_jw/Desktop/dino_wm/outputs/260301/10-03/', 'model_epoch': 'latest', 'mode': 'online', 'goal_H': 5, 'num_samples': 300, 'opt_steps': 5, 'topk': 30, 'action_dim': 16, 'base_action_dim': 8, 'frameskip': 2, 'search_dim': 80, 'training_config': {'ckpt_base_path': './', 'training': {'seed': 0, 'epochs': 100, 'batch_size': 4, 'save_every_x_epoch': 1, 'reconstruct_every_x_batch': 500, 'num_reconstruct_samples': 6, 'encoder_lr': 1e-06, 'decoder_lr': 0.0001, 'predictor_lr': 0.0002, 'action_encoder_lr': 0.0005}, 'img_size': 224, 'frameskip': 2, 'concat_dim': 1, 'normalize_action': True, 'action_emb_dim': 10, 'num_action_repeat': 1, 'proprio_emb_dim': 10, 'num_proprio_repeat': 1, 'num_hist': 6, 'num_pred': 1, 'has_predictor': True, 'has_decoder': True, 'model': {'_target_': 'models.visual_world_model.VWorldModel', 'image_size': 224, 'num_hist': 6, 'num_pred': 1, 'train_encoder': False, 'train_predictor': True, 'train_decoder': True}, 'debug': False, 'plan_settings': {'plan_cfg_path': None, 'planner': ['gd', 'cem'], 'goal_source': ['dset', 'random_state'], 'goal_H': [5], 'alpha': [0.1, 1]}, 'env': {'name': 'franka_cube_stack', 'args': [], 'kwargs': {}, 'action_dim': 8, 'state_dim': 14, 'proprio_dim': 3, 'dataset': {'_target_': 'datasets.franka_cube_stack_dset.load_franka_cube_stack_slice_train_val', 'n_rollout': None, 'normalize_action': True, 'data_path': '/media/tsp_jw/data/DINO_WM/fcs_datasets/20260228_1703_NEps1000_RobOpac0_NPrim20_NCams2_NCube1_EEFfix_TrackGrip_ChannelStack_GrGrDiff', 'split_ratio': 0.9, 'transform': {'_target_': 'datasets.img_transforms.default_transform', 'img_size': [224, 224]}}, 'decoder_path': None, 'num_workers': 2}, 'encoder': {'_target_': 'models.dino.DinoV2Encoder', 'name': 'dinov2_vits14', 'feature_key': 'x_norm_patchtokens'}, 'action_encoder': {'_target_': 'models.proprio.ProprioceptiveEmbedding', 'num_frames': 1, 'tubelet_size': 1, 'use_3d_pos': False}, 'proprio_encoder': {'_target_': 'models.proprio.ProprioceptiveEmbedding', 'num_frames': 2, 'tubelet_size': 1, 'use_3d_pos': False}, 'decoder': {'_target_': 'models.vqvae.VQVAE', 'channel': 384, 'n_embed': 2048, 'n_res_block': 4, 'n_res_channel': 128, 'quantize': False}, 'predictor': {'_target_': 'models.vit.ViTPredictor', 'depth': 6, 'heads': 16, 'mlp_dim': 2048, 'dropout': 0.1, 'emb_dropout': 0, 'pool': 'mean'}, 'saved_folder': '/home/tsp_jw/Desktop/dino_wm/outputs/260301/10-03', 'effective_batch_size': 4, 'gpu_batch_size': 4, 'wandb_run_id': 'kf6euq2k'}, 'port': 5555, 'chunk_size': None, 'n_sub_actions': 1}
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_init.py:init():548] starting backend
2026-03-01 12:51:50,768 INFO    MainThread:2366777 [wandb_init.py:init():552] setting up manager
2026-03-01 12:51:50,770 INFO    MainThread:2366777 [backend.py:_multiprocessing_setup():97] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2026-03-01 12:51:50,771 INFO    MainThread:2366777 [wandb_init.py:init():558] backend started and connected
2026-03-01 12:51:50,773 INFO    MainThread:2366777 [wandb_init.py:init():636] updated telemetry
2026-03-01 12:51:50,777 INFO    MainThread:2366777 [wandb_init.py:init():667] communicating run to backend with 30 second timeout
2026-03-01 12:51:51,294 INFO    MainThread:2366777 [wandb_run.py:_on_init():1982] communicating current version
2026-03-01 12:51:51,361 INFO    MainThread:2366777 [wandb_run.py:_on_init():1986] got version response upgrade_message: "wandb version 0.25.0 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2026-03-01 12:51:51,361 INFO    MainThread:2366777 [wandb_init.py:init():700] starting run threads in backend
2026-03-01 12:51:56,374 INFO    MainThread:2366777 [wandb_run.py:_console_start():1962] atexit reg
2026-03-01 12:51:56,374 INFO    MainThread:2366777 [wandb_run.py:_redirect():1820] redirect: SettingsConsole.WRAP_RAW
2026-03-01 12:51:56,374 INFO    MainThread:2366777 [wandb_run.py:_redirect():1885] Wrapping output streams.
2026-03-01 12:51:56,374 INFO    MainThread:2366777 [wandb_run.py:_redirect():1907] Redirects installed.
2026-03-01 12:51:56,375 INFO    MainThread:2366777 [wandb_init.py:init():732] run started, returning control to user process
2026-03-01 13:18:29,508 INFO    MainThread:2366777 [wandb_run.py:_config_callback():1152] config_cb None None {'client': {'port': 5555, 'n_episodes': 5, 'max_steps': 50, 'headless': False, 'goal_image': '/media/tsp_jw/data/DINO_WM/fcs_datasets/20260228_1703_NEps1000_RobOpac0_NPrim20_NCams2_NCube1_EEFfix_TrackGrip_ChannelStack_GrGrDiff~:2:-1', 'settle_steps': 20, 'ee_threshold': 0.005, 'timeout': 1000, 'mode': 'online', 'log_dir': None, 'robot_opacity_for_capture': 0.0, 'scene_config': {'seed': 111, 'cube_size': 0.05, 'n_cubes': 1, 'min_dist_factor': 1.5, 'max_placement_tries': 200, 'yaw_range': [0.0, 0.0], 'scene_width': 0.6, 'scene_length': 0.75, 'plane_lift': 0.001, 'scene': {'width': 0.6, 'length': 0.75, 'plane_lift': 0.001}, 'robot_base_clearance': 0.3, 'robot_max_reach': 0.75, 'robot_min_reach': 0.3, 'cam_resolution': [224, 224], 'cam_frequency': 20, 'robot_opacity_for_capture': 0.0, 'cameras': [{'name': 'front_right', 'position': [1.6, -2.0, 1.27], 'euler': [66.0, 0.0, 32.05]}, {'name': 'front_left', 'position': [1.6, 2.0, 1.27], 'euler': [66.0, 0.0, 147.95]}], 'fusion': {'enabled': True, 'mode': 'channel_stack', 'channel_mode': 'anaglyph3d', 'primary_camera': 0, 'secondary_camera': 1, 'alpha': 0.5}, 'visual_randomization': {'enabled': False, 'fixed_cube_color': [0.9, 0.1, 0.1], 'fixed_plane_rgba': [0.82, 0.82, 0.82, 1.0], 'fixed_light': {'position': [0.4, 0.0, 2.0], 'intensity': 8000.0, 'radius': 0.5}}, 'vis_rand_enabled': False, 'fixed_cube_color': [0.9, 0.1, 0.1], 'fixed_plane_rgba': [0.82, 0.82, 0.82, 1.0], 'fixed_light': {'position': [0.4, 0.0, 2.0], 'intensity': 8000.0, 'radius': 0.5}, 'dataset_path': '/media/tsp_jw/data/DINO_WM/fcs_datasets', 'dataset_name': 'NEps1000_RobOpac0_NPrim20_NCams2_FuseChStack_NCube1_EEFfix_TrackGrip', 'controller': {'trajectory_resolution': 1.0, 'air_speed_multiplier': 1.0, 'height_adaptive_speed': False, 'critical_height_threshold': 0.1, 'critical_speed_factor': 0.5, 'air_dt': 1.0, 'critical_dt': 0.01, 'wait_dt': 0.5, 'grip_dt': 0.15, 'release_dt': 0.15, 'guarantee_final_position': True, 'guarantee_phases': [1, 6], 'eef_orientation_mode': 'fixed', 'fixed_eef_orientation': [0.0, 0.0, 1.0, 0.0], 'wrist_hard_lock': False}}}}
2026-03-01 13:19:49,546 INFO    MainThread:2366777 [wandb_run.py:_config_callback():1152] config_cb None None {'client': {'port': 5555, 'n_episodes': 5, 'max_steps': 50, 'headless': False, 'goal_image': '/media/tsp_jw/data/DINO_WM/fcs_datasets/20260228_1703_NEps1000_RobOpac0_NPrim20_NCams2_NCube1_EEFfix_TrackGrip_ChannelStack_GrGrDiff:2:-1', 'settle_steps': 20, 'ee_threshold': 0.005, 'timeout': 1000, 'mode': 'online', 'log_dir': None, 'robot_opacity_for_capture': 0.0, 'scene_config': {'seed': 111, 'cube_size': 0.05, 'n_cubes': 1, 'min_dist_factor': 1.5, 'max_placement_tries': 200, 'yaw_range': [0.0, 0.0], 'scene_width': 0.6, 'scene_length': 0.75, 'plane_lift': 0.001, 'scene': {'width': 0.6, 'length': 0.75, 'plane_lift': 0.001}, 'robot_base_clearance': 0.3, 'robot_max_reach': 0.75, 'robot_min_reach': 0.3, 'cam_resolution': [224, 224], 'cam_frequency': 20, 'robot_opacity_for_capture': 0.0, 'cameras': [{'name': 'front_right', 'position': [1.6, -2.0, 1.27], 'euler': [66.0, 0.0, 32.05]}, {'name': 'front_left', 'position': [1.6, 2.0, 1.27], 'euler': [66.0, 0.0, 147.95]}], 'fusion': {'enabled': True, 'mode': 'channel_stack', 'channel_mode': 'anaglyph3d', 'primary_camera': 0, 'secondary_camera': 1, 'alpha': 0.5}, 'visual_randomization': {'enabled': False, 'fixed_cube_color': [0.9, 0.1, 0.1], 'fixed_plane_rgba': [0.82, 0.82, 0.82, 1.0], 'fixed_light': {'position': [0.4, 0.0, 2.0], 'intensity': 8000.0, 'radius': 0.5}}, 'vis_rand_enabled': False, 'fixed_cube_color': [0.9, 0.1, 0.1], 'fixed_plane_rgba': [0.82, 0.82, 0.82, 1.0], 'fixed_light': {'position': [0.4, 0.0, 2.0], 'intensity': 8000.0, 'radius': 0.5}, 'dataset_path': '/media/tsp_jw/data/DINO_WM/fcs_datasets', 'dataset_name': 'NEps1000_RobOpac0_NPrim20_NCams2_FuseChStack_NCube1_EEFfix_TrackGrip', 'controller': {'trajectory_resolution': 1.0, 'air_speed_multiplier': 1.0, 'height_adaptive_speed': False, 'critical_height_threshold': 0.1, 'critical_speed_factor': 0.5, 'air_dt': 1.0, 'critical_dt': 0.01, 'wait_dt': 0.5, 'grip_dt': 0.15, 'release_dt': 0.15, 'guarantee_final_position': True, 'guarantee_phases': [1, 6], 'eef_orientation_mode': 'fixed', 'fixed_eef_orientation': [0.0, 0.0, 1.0, 0.0], 'wrist_hard_lock': False}}}}

  W&B Run: https://wandb.ai/jacob-weyer-rwth-aachen-university/dino_wm_planning/runs/etufmr4w
✓ Setup komplett
  Modus: ONLINE
  CEM: samples=300, steps=30, topk=30, horizon=5
  Suchraum: 60D (H=5 × D=12)
Server laeuft auf localhost:5555
Warte auf Client...
[+] Client: ('127.0.0.1', 42098)
  W&B Config aktualisiert mit Client-Config (11 Keys)
  Client-Config empfangen: ['port', 'n_episodes', 'max_steps', 'headless', 'goal_image', 'settle_steps', 'ee_threshold', 'timeout', 'mode', 'log_dir', 'scene_config']
  Reset
  Goal gesetzt: (224, 224, 3) uint8, ee_pos=[ 0.5861372  -0.19599408  0.0685048 ]
    CEM step 1: loss=0.908831
    CEM step 2: loss=0.586348
    CEM step 3: loss=0.491326
    CEM step 4: loss=0.500251
    CEM step 5: loss=0.462251
    CEM step 6: loss=0.397768
    CEM step 7: loss=0.456940
    CEM step 8: loss=0.443184
    CEM step 9: loss=0.423656
    CEM step 10: loss=0.413211
    CEM step 11: loss=0.412241
    CEM step 12: loss=0.407103
    CEM step 13: loss=0.398756
    CEM step 14: loss=0.383594
    CEM step 15: loss=0.387807
    CEM step 16: loss=0.389755
    CEM step 17: loss=0.367762
    CEM step 18: loss=0.374582
    CEM step 19: loss=0.368307
    CEM step 20: loss=0.372467
    CEM step 21: loss=0.352991
    CEM step 22: loss=0.359298
    CEM step 23: loss=0.360166
    CEM step 24: loss=0.358122
    CEM step 25: loss=0.352155
    CEM step 26: loss=0.340513
    CEM step 27: loss=0.339972
    CEM step 28: loss=0.337114
    CEM step 29: loss=0.334463
    CEM step 30: loss=0.332602
  Plan: 0.908831 → 0.332602 (63.4% Reduktion, 318.7s)
    Sub-Action 0: target_ee=[0.407, -0.020, 0.201]
    Sub-Action 1: target_ee=[0.524, -0.049, 0.093]
    CEM step 1: loss=0.514219
    CEM step 2: loss=0.468381
    CEM step 3: loss=0.454034
    CEM step 4: loss=0.443788
    CEM step 5: loss=0.371847
    CEM step 6: loss=0.362147
    CEM step 7: loss=0.385480
    CEM step 8: loss=0.372185
    CEM step 9: loss=0.366723
    CEM step 10: loss=0.351415
    CEM step 11: loss=0.372074
    CEM step 12: loss=0.347588
    CEM step 13: loss=0.346869
    CEM step 14: loss=0.336703
    CEM step 15: loss=0.338346
    CEM step 16: loss=0.343218
    CEM step 17: loss=0.328709
    CEM step 18: loss=0.321716
    CEM step 19: loss=0.315894
    CEM step 20: loss=0.311957
    CEM step 21: loss=0.303631
    CEM step 22: loss=0.303785
    CEM step 23: loss=0.302092
    CEM step 24: loss=0.297114
    CEM step 25: loss=0.299687
    CEM step 26: loss=0.299502
    CEM step 27: loss=0.297509
    CEM step 28: loss=0.293540
    CEM step 29: loss=0.293158
    CEM step 30: loss=0.290866
  Plan: 0.514219 → 0.290866 (43.4% Reduktion, 318.4s)
    Sub-Action 0: target_ee=[0.516, -0.129, 0.235]
    Sub-Action 1: target_ee=[0.538, -0.078, 0.082]
    CEM step 1: loss=0.426974
    CEM step 2: loss=0.498415
    CEM step 3: loss=0.474730
    CEM step 4: loss=0.464479
    CEM step 5: loss=0.439355
    CEM step 6: loss=0.422500
    CEM step 7: loss=0.415717
    CEM step 8: loss=0.412671
    CEM step 9: loss=0.412027
    CEM step 10: loss=0.401432
    CEM step 11: loss=0.395570
    CEM step 12: loss=0.383067
    CEM step 13: loss=0.378162
    CEM step 14: loss=0.372887
    CEM step 15: loss=0.365853
    CEM step 16: loss=0.363063
    CEM step 17: loss=0.369120
    CEM step 18: loss=0.364151
    CEM step 19: loss=0.359829
    CEM step 20: loss=0.357720
    CEM step 21: loss=0.355296
    CEM step 22: loss=0.352153
    CEM step 23: loss=0.347451
    CEM step 24: loss=0.346361
    CEM step 25: loss=0.344649
    CEM step 26: loss=0.341111
    CEM step 27: loss=0.338713
    CEM step 28: loss=0.339234
    CEM step 29: loss=0.334664
    CEM step 30: loss=0.332623
  Plan: 0.426974 → 0.332623 (22.1% Reduktion, 319.5s)
    Sub-Action 0: target_ee=[0.622, 0.053, 0.088]
    Sub-Action 1: target_ee=[0.556, -0.163, 0.128]
    CEM step 1: loss=0.511446
    CEM step 2: loss=0.506083
    CEM step 3: loss=0.504531
    CEM step 4: loss=0.416617
    CEM step 5: loss=0.435221
    CEM step 6: loss=0.404611
    CEM step 7: loss=0.436834
    CEM step 8: loss=0.409817
    CEM step 9: loss=0.394192
    CEM step 10: loss=0.401864
    CEM step 11: loss=0.386404
    CEM step 12: loss=0.373724
    CEM step 13: loss=0.369945
    CEM step 14: loss=0.361173
    CEM step 15: loss=0.363956
    CEM step 16: loss=0.354923
    CEM step 17: loss=0.336615
    CEM step 18: loss=0.328683
    CEM step 19: loss=0.324576
    CEM step 20: loss=0.322934
    CEM step 21: loss=0.323864
    CEM step 22: loss=0.322803
    CEM step 23: loss=0.320463
    CEM step 24: loss=0.319721
    CEM step 25: loss=0.319106
    CEM step 26: loss=0.320612
    CEM step 27: loss=0.318394
    CEM step 28: loss=0.318512
    CEM step 29: loss=0.317244
    CEM step 30: loss=0.316734
  Plan: 0.511446 → 0.316734 (38.1% Reduktion, 319.5s)
    Sub-Action 0: target_ee=[0.385, -0.053, 0.186]
    Sub-Action 1: target_ee=[0.547, -0.009, 0.149]
    CEM step 1: loss=0.431127
    CEM step 2: loss=0.514680
    CEM step 3: loss=0.441510
    CEM step 4: loss=0.444572
    CEM step 5: loss=0.392788
    CEM step 6: loss=0.381421
    CEM step 7: loss=0.380167
    CEM step 8: loss=0.389829
    CEM step 9: loss=0.359439
    CEM step 10: loss=0.362266
    CEM step 11: loss=0.358299
    CEM step 12: loss=0.324196
    CEM step 13: loss=0.357500
    CEM step 14: loss=0.351038
    CEM step 15: loss=0.347772
    CEM step 16: loss=0.340810
    CEM step 17: loss=0.336582
    CEM step 18: loss=0.335873
    CEM step 19: loss=0.333169
    CEM step 20: loss=0.331693
    CEM step 21: loss=0.331394
    CEM step 22: loss=0.329192
    CEM step 23: loss=0.328063
    CEM step 24: loss=0.324596
    CEM step 25: loss=0.322775
    CEM step 26: loss=0.321128
    CEM step 27: loss=0.318965
    CEM step 28: loss=0.316776
    CEM step 29: loss=0.315960
    CEM step 30: loss=0.314668
  Plan: 0.431127 → 0.314668 (27.0% Reduktion, 316.0s)
    Sub-Action 0: target_ee=[0.086, -0.341, 0.189]
    Sub-Action 1: target_ee=[0.550, -0.108, 0.193]
    CEM step 1: loss=0.542820
    CEM step 2: loss=0.511066
    CEM step 3: loss=0.445768
    CEM step 4: loss=0.483448
    CEM step 5: loss=0.495711
    CEM step 6: loss=0.441617
    CEM step 7: loss=0.400769
    CEM step 8: loss=0.399851
    CEM step 9: loss=0.390636
    CEM step 10: loss=0.381093
    CEM step 11: loss=0.369816
    CEM step 12: loss=0.373811
    CEM step 13: loss=0.374542
    CEM step 14: loss=0.376295
    CEM step 15: loss=0.366448
    CEM step 16: loss=0.365539
    CEM step 17: loss=0.365290
    CEM step 18: loss=0.352089
    CEM step 19: loss=0.356810
    CEM step 20: loss=0.358096
    CEM step 21: loss=0.353001
    CEM step 22: loss=0.352369
    CEM step 23: loss=0.348331
    CEM step 24: loss=0.347336
    CEM step 25: loss=0.346855
    CEM step 26: loss=0.339251
    CEM step 27: loss=0.338513
    CEM step 28: loss=0.337854
    CEM step 29: loss=0.333609
    CEM step 30: loss=0.335271
  Plan: 0.542820 → 0.335271 (38.2% Reduktion, 319.1s)
    Sub-Action 0: target_ee=[0.444, -0.003, 0.010]
    Sub-Action 1: target_ee=[0.543, -0.216, 0.202]
    CEM step 1: loss=0.549372
    CEM step 2: loss=0.508286
    CEM step 3: loss=0.498825
    CEM step 4: loss=0.476427
    CEM step 5: loss=0.444284
    CEM step 6: loss=0.379754
    CEM step 7: loss=0.422768
    CEM step 8: loss=0.428705
    CEM step 9: loss=0.395153
    CEM step 10: loss=0.372722
    CEM step 11: loss=0.363826
    CEM step 12: loss=0.357261
    CEM step 13: loss=0.352493
    CEM step 14: loss=0.350406
    CEM step 15: loss=0.346721
    CEM step 16: loss=0.344365
    CEM step 17: loss=0.343608
    CEM step 18: loss=0.335441
    CEM step 19: loss=0.341044
    CEM step 20: loss=0.331162
    CEM step 21: loss=0.334909
    CEM step 22: loss=0.331551
    CEM step 23: loss=0.327347
    CEM step 24: loss=0.324297
    CEM step 25: loss=0.320460
    CEM step 26: loss=0.319521
    CEM step 27: loss=0.317741
    CEM step 28: loss=0.316184
    CEM step 29: loss=0.315678
    CEM step 30: loss=0.314194
  Plan: 0.549372 → 0.314194 (42.8% Reduktion, 317.5s)
    Sub-Action 0: target_ee=[0.551, -0.265, 0.148]
    Sub-Action 1: target_ee=[0.504, -0.106, 0.216]
    CEM step 1: loss=0.661217
    CEM step 2: loss=0.569910
    CEM step 3: loss=0.565786
    CEM step 4: loss=0.528863
    CEM step 5: loss=0.511897
    CEM step 6: loss=0.495461
[-] Client getrennt
Traceback (most recent call last):
  File "/home/tsp_jw/Desktop/dino_wm/planning_server.py", line 527, in <module>
  File "/home/tsp_jw/Desktop/dino_wm/planning/cem.py", line 108, in plan
    i_z_obses, i_zs = self.wm.rollout(
  File "/home/tsp_jw/Desktop/dino_wm/planning_server.py", line 188, in rollout
    end = min(start + self.chunk_size, B)
  File "/home/tsp_jw/Desktop/dino_wm/models/visual_world_model.py", line 305, in rollout
    z_pred = self.predict(z[:, -self.num_hist :])
  File "/home/tsp_jw/Desktop/dino_wm/models/visual_world_model.py", line 145, in predict
    z = self.predictor(z)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 119, in forward
    x = self.transformer(x)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 95, in forward
    x = attn(x) + x
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 71, in forward
    dots = torch.matmul(q, k.transpose(-1, -2)) * self.scale
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/tsp_jw/Desktop/dino_wm/planning_server.py", line 527, in <module>
  File "/home/tsp_jw/Desktop/dino_wm/planning/cem.py", line 108, in plan
    i_z_obses, i_zs = self.wm.rollout(
  File "/home/tsp_jw/Desktop/dino_wm/planning_server.py", line 188, in rollout
    end = min(start + self.chunk_size, B)
  File "/home/tsp_jw/Desktop/dino_wm/models/visual_world_model.py", line 305, in rollout
    z_pred = self.predict(z[:, -self.num_hist :])
  File "/home/tsp_jw/Desktop/dino_wm/models/visual_world_model.py", line 145, in predict
    z = self.predictor(z)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 119, in forward
    x = self.transformer(x)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 95, in forward
    x = attn(x) + x
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/tsp_jw/miniconda3/envs/dino_wm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/tsp_jw/Desktop/dino_wm/models/vit.py", line 71, in forward
    dots = torch.matmul(q, k.transpose(-1, -2)) * self.scale
KeyboardInterrupt